<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>可切换地图</title>
    <!-- 引入 ECharts 文件 -->
    <script src="https://cdn.jsdelivr.net/npm/echarts/dist/echarts.min.js"></script>
    <!-- 引入中国地图数据 -->
    <script src="https://cdn.jsdelivr.net/npm/echarts/map/js/china.js"></script>
    <!-- 引入世界地图数据 -->
    <script src="https://cdn.jsdelivr.net/npm/echarts/map/js/world.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f2f2f2;
            overflow-x: hidden; /* Hide horizontal scrollbar */
        }
        .container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 20px;
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            animation: fadeIn 0.5s ease-in-out; /* Fade-in animation */
        }
        .mapContainer {
            width: 48%;
            height: 600px;
            border: 1px solid #ccc;
            border-radius: 8px;
            overflow: hidden;
            animation: slideIn 0.5s ease-in-out; /* Slide-in animation */
        }
        .searchBox {
            width: 100%;
            margin-bottom: 20px;
            padding: 12px;
            font-size: 16px;
            border: 1px solid #ccc;
            border-radius: 8px;
            box-sizing: border-box;
            background-color: #f9f9f9;
            animation: slideIn 0.5s ease-in-out; /* Slide-in animation */
        }

        /* Keyframe animations */
        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }
        @keyframes slideIn {
            from {
                transform: translateY(-20px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }
    </style>
</head>
<body>
  <div class="container">
    <!-- 为 ECharts 准备一个定义了宽高的 DOM -->
    <div id="chinaMap" class="mapContainer"></div>
    <!-- 为 ECharts 准备一个定义了宽高的 DOM -->
    <div id="worldMap" class="mapContainer"></div>
  </div>
  <!-- 搜索框 -->
  <input type="text" id="searchBox" class="searchBox" placeholder="搜索地图" onkeyup="searchMap()">
  <script type="text/javascript">
    // 初始化 ECharts 实例
    var chinaChart = echarts.init(document.getElementById('chinaMap'));
    var worldChart = echarts.init(document.getElementById('worldMap'));

    // 初始地图数据为空
    var emptyData = [];

    // 加载地图数据
    var chinaMapDataSets;
    var worldMapDataSets;

    Promise.all([
        fetch('static/datasets/maps_china.json').then(response => response.json()),
        fetch('static/datasets/maps.json').then(response => response.json())
    ]).then(function(results) {
        chinaMapDataSets = results[0];
        worldMapDataSets = results[1];
    }).catch(function(error) {
        console.error('加载地图数据时发生错误:', error);
    });

    // 配置地图
    var chinaOption = {
        title: {
            text: '中国地图（带高亮省份）',
            left: 'center'
        },
        tooltip: {
            trigger: 'item'
        },
        series: [
            {
                name: '高亮省份',
                type: 'map',
                map: 'china', // 使用中国地图
                roam: true,
                label: {
                    show: true,
                    fontSize: 12
                },
                data: emptyData // 初始显示为空地图
            }
        ]
    };

    var worldOption = {
        title: {
            text: '世界地图（带高亮国家）',
            left: 'center'
        },
        tooltip: {
            trigger: 'item'
        },
        series: [
            {
                name: '高亮国家',
                type: 'map',
                map: 'world', // 使用世界地图
                roam: true,
                label: {
                    show: true, // 显示标签
                    formatter: function(params) {
                        if (params.data) {
                            return '{a|' + params.name + '}';
                        } else {
                            return ''; // 如果数据为空则不显示标签
                        }
                    },
                    rich: {
                        a: {
                            fontSize: 12,
                            color: '#000', // 标签颜色
                            fontWeight: 'bold' // 标签加粗
                        }
                    }
                },
                data: emptyData // 初始显示为空地图
            }
        ]
    };

    // 使用配置项和数据展示图表
    chinaChart.setOption(chinaOption);
    worldChart.setOption(worldOption);

    // 搜索地图函数
    function searchMap() {
        var searchBox = document.getElementById('searchBox');
        var searchKeyword = searchBox.value.trim().toLowerCase();

        var chinaMapData = chinaMapDataSets[searchKeyword];
        var worldMapData = worldMapDataSets[searchKeyword];

        if (chinaMapData || worldMapData) {
            // 如果找到了对应的地图数据集合，则显示相应的地图数据
            chinaChart.setOption({
                series: [
                    {
                        data: chinaMapData || emptyData // 显示对应的中国地图数据或者空地图
                    }
                ]
            });

            worldChart.setOption({
                series: [
                    {
                        data: worldMapData || emptyData // 显示对应的世界地图数据或者空地图
                    }
                ]
            });
        } else {
            // 如果找不到对应的地图数据集合，则显示空地图
            chinaChart.setOption({
                series: [
                    {
                        data: emptyData // 空地图
                    }
                ]
            });

            worldChart.setOption({
                series: [
                    {
                        data: emptyData // 空地图
                    }
                ]
            });
        }
    }
  </script>
</body>
</html>
