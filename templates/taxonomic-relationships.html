<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plant Taxonomy</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        text {
            font-family: Arial, sans-serif;
            font-size: 12px;
        }
        circle {
            fill: #fff;
            stroke: #007bff;
            stroke-width: 2px;
        }
        path {
            fill: none;
            stroke: #888;
            stroke-width: 1px;
        }
    </style>
</head>
<body>
    <svg width="800" height="800"></svg>

    <script>
        // 数据
        const data = {
            "name": "Plants",
            "children": [
                {"name": "植物界", "children": [
                    {"name": "被子植物门", "children": [
                        {"name": "双子叶植物纲", "children": [
                            {"name": "杜鹃花目", "children": [
                                {"name": "凤仙花科", "children": [
                                    {"name": "凤仙花属"}
                                ]}
                            ]},
                            {"name": "中央种子目", "children": [
                                {"name": "石竹科", "children": [
                                    {"name": "石柱属"}
                                ]}
                            ]},
                            {"name": "菊目", "children": [
                                {"name": "菊科", "children": [
                                    {"name": "天人菊属"}
                                ]}
                            ]},
                            {"name": "", "children": [
                                {"name": "十字花科", "children": [
                                    {"name": "诸葛菜属"}
                                ]}
                            ]}
                        ]}
                    ]}
                ]}
            ]
        };

        // 创建一个 cluster 布局
        const clusterLayout = d3.cluster()
            .size([2 * Math.PI, 400]);

        // 将数据转换为层次结构
        const root = d3.hierarchy(data);

        // 对数据进行布局
        const treeData = clusterLayout(root);

        // 创建一个 SVG 容器
        const svg = d3.select("svg")
            .attr("width", 800)
            .attr("height", 800)
            .append("g")
            .attr("transform", "translate(400, 400)");

        // 创建连线生成器
        const linkGenerator = d3.linkRadial()
            .angle(d => d.x)
            .radius(d => d.y);

        // 绘制连线
        svg.selectAll("path")
            .data(treeData.links())
            .enter().append("path")
            .attr("d", linkGenerator);

        // 绘制节点
        const nodes = svg.selectAll("g")
            .data(treeData.descendants())
            .enter().append("g")
            .attr("transform", d => `rotate(${d.x * 180 / Math.PI - 90}) translate(${d.y},0)`);

        nodes.append("circle")
            .attr("r", 5);

        nodes.append("text")
            .text(d => d.data.name)
            .attr("dx", d => d.x < Math.PI ? 10 : -10)
            .attr("dy", 4)
            .attr("text-anchor", d => d.x < Math.PI ? "start" : "end");
    </script>
</body>
</html>
